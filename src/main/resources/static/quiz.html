<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>DSA Quiz - SMART CAREER NAVIGATOR</title>

    <style>
        body {
            background: #000428;
            background: linear-gradient(to bottom, #000428, #004e92);
            font-family: Arial;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .question-box {
            margin-top: 40px;
            padding: 20px;
            border: 2px solid #0ff;
            border-radius: 15px;
            background: rgba(0,0,0,0.3);
            box-shadow: 0px 0px 20px cyan;
            width: 80%;
            margin-left: auto;
            margin-right: auto;
        }

        .option-btn {
            width: 80%;
            padding: 12px;
            margin: 10px auto;
            font-size: 18px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            background: #012b70;
            color: white;
            transition: 0.2s;
        }

        .option-btn:hover {
            transform: scale(1.03);
        }

        .correct {
            background: #00c853 !important;
        }

        .wrong {
            background: #d50000 !important;
        }

        #next-btn {
            background: #0288d1;
            display: none;
        }
    </style>
</head>

<body>

<h1>ðŸŽ¯ DSA Quiz - SMART CAREER NAVIGATOR</h1>

<div id="quiz-container" class="question-box">
    <h2 id="question">Loading...</h2>

    <button class="option-btn"></button>
    <button class="option-btn"></button>
    <button class="option-btn"></button>
    <button class="option-btn"></button>

    <!-- â­ NEXT BUTTON HERE (IMPORTANT) -->
    <button id="next-btn" class="option-btn">Next</button>
</div>

<script>
let questions = [];
let currentQuestion = 0;
let score = 0;

async function loadQuestions() {
    try {
        const response = await fetch("https://smartcareernav.onrender.com/api/quiz/generate", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ topic: "DSA", difficulty: "easy" })
        });

        const data = await response.json();
        console.log("Questions Loaded:", data);

        questions = Object.keys(data).map(k => ({
            question: data[k].question,
            options: data[k].options,
            answer: data[k].answer   // Answer TEXT
        }));

        showQuestion();

    } catch (err) {
        console.error(err);
        document.getElementById("question").innerText = "âŒ Error loading questions.";
    }
}

function showQuestion() {
    const q = questions[currentQuestion];

    document.getElementById("question").innerText =
        `Q${currentQuestion + 1}. ${q.question}`;

    const buttons = document.querySelectorAll(".option-btn");
    const nextBtn = document.getElementById("next-btn");

    nextBtn.style.display = "none";

    buttons.forEach((btn, index) => {
        if (btn.id !== "next-btn") {
            btn.classList.remove("correct", "wrong");
            btn.innerText = q.options[index];
            btn.onclick = () => checkAnswer(btn, q.options[index], q.answer);
        }
    });
}

function checkAnswer(btn, selected, correct) {
    const buttons = document.querySelectorAll(".option-btn");
    const nextBtn = document.getElementById("next-btn");

    buttons.forEach(b => b.onclick = null);

    if (selected === correct) {
        btn.classList.add("correct");
        score++;
    } else {
        btn.classList.add("wrong");
        buttons.forEach(b => {
            if (b.innerText === correct) b.classList.add("correct");
        });
    }

    nextBtn.style.display = "block";

    nextBtn.onclick = () => {
        currentQuestion++;
        if (currentQuestion < questions.length) {
            showQuestion();
        } else {
            finishQuiz();
        }
    };
}

function finishQuiz() {
    document.getElementById("quiz-container").innerHTML = `
        <h2>ðŸŽ‰ Quiz Completed</h2>
        <h3>Your Score: ${score} / ${questions.length}</h3>
        <button class="option-btn" onclick="location.reload()">Restart</button>
    `;
}

loadQuestions();
</script>

</body>
</html>
